webpackJsonp([14],{Bq2z:function(n,t,e){var a=e("GdcN");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("rjj0")("6a8f353f",a,!0)},GdcN:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},iINV:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={components:{},props:{},data:function(){return{attrGroupId:0,visible:!1,innerVisible:!1,relationAttrs:[],dataListSelections:[],dataForm:{key:""},dataList:[],pageIndex:1,pageSize:10,totalPage:0,dataListLoading:!1,innerdataListSelections:[]}},computed:{},watch:{},methods:{selectionChangeHandle:function(n){this.dataListSelections=n},innerSelectionChangeHandle:function(n){this.innerdataListSelections=n},addRelation:function(){this.getDataList(),this.innerVisible=!0},batchDeleteRelation:function(n){var t=this,e=[];this.dataListSelections.forEach(function(n){e.push({attrId:n.attrId,attrGroupId:t.attrGroupId})}),this.$http({url:this.$http.adornUrl("/product/attrgroup/attr/relation/delete"),method:"post",data:this.$http.adornData(e,!1)}).then(function(n){var e=n.data;0==e.code?(t.$message({type:"success",message:"删除成功"}),t.init(t.attrGroupId)):t.$message({type:"error",message:e.msg})})},relationRemove:function(n){var t=this,e=[];e.push({attrId:n,attrGroupId:this.attrGroupId}),this.$http({url:this.$http.adornUrl("/product/attrgroup/attr/relation/delete"),method:"post",data:this.$http.adornData(e,!1)}).then(function(n){var e=n.data;0==e.code?(t.$message({type:"success",message:"删除成功"}),t.init(t.attrGroupId)):t.$message({type:"error",message:e.msg})})},submitAddRealtion:function(){var n=this;if(this.innerVisible=!1,console.log("准备新增的数据",this.innerdataListSelections),this.innerdataListSelections.length>0){var t=[];this.innerdataListSelections.forEach(function(e){t.push({attrId:e.attrId,attrGroupId:n.attrGroupId})}),this.$http({url:this.$http.adornUrl("/product/attrgroup/attr/relation"),method:"post",data:this.$http.adornData(t,!1)}).then(function(t){0==t.data.code&&n.$message({type:"success",message:"新增关联成功"}),n.$emit("refreshData"),n.init(n.attrGroupId)})}},init:function(n){var t=this;this.attrGroupId=n||0,this.visible=!0,this.$http({url:this.$http.adornUrl("/product/attrgroup/"+this.attrGroupId+"/attr/relation"),method:"get",params:this.$http.adornParams({})}).then(function(n){var e=n.data;t.relationAttrs=e.data})},dialogClose:function(){},getDataList:function(){var n=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/product/attrgroup/"+this.attrGroupId+"/noattr/relation"),method:"get",params:this.$http.adornParams({page:this.pageIndex,limit:this.pageSize,key:this.dataForm.key})}).then(function(t){var e=t.data;e&&0===e.code?(n.dataList=e.page.list,n.totalPage=e.page.totalCount):(n.dataList=[],n.totalPage=0),n.dataListLoading=!1})},sizeChangeHandle:function(n){this.pageSize=n,this.pageIndex=1,this.getDataList()},currentChangeHandle:function(n){this.pageIndex=n,this.getDataList()}}},i={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",[e("el-dialog",{attrs:{"close-on-click-modal":!1,visible:n.visible},on:{"update:visible":function(t){n.visible=t},closed:n.dialogClose}},[e("el-dialog",{attrs:{width:"40%",title:"选择属性",visible:n.innerVisible,"append-to-body":""},on:{"update:visible":function(t){n.innerVisible=t}}},[e("div",[e("el-form",{attrs:{inline:!0,model:n.dataForm},nativeOn:{keyup:function(t){if(!("button"in t)&&n._k(t.keyCode,"enter",13,t.key,"Enter"))return null;n.getDataList()}}},[e("el-form-item",[e("el-input",{attrs:{placeholder:"参数名",clearable:""},model:{value:n.dataForm.key,callback:function(t){n.$set(n.dataForm,"key",t)},expression:"dataForm.key"}})],1),n._v(" "),e("el-form-item",[e("el-button",{on:{click:function(t){n.getDataList()}}},[n._v("查询")])],1)],1),n._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:n.dataList,border:""},on:{"selection-change":n.innerSelectionChangeHandle}},[e("el-table-column",{attrs:{type:"selection","header-align":"center",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"attrId","header-align":"center",align:"center",label:"属性id"}}),n._v(" "),e("el-table-column",{attrs:{prop:"attrName","header-align":"center",align:"center",label:"属性名"}}),n._v(" "),e("el-table-column",{attrs:{prop:"icon","header-align":"center",align:"center",label:"属性图标"}}),n._v(" "),e("el-table-column",{attrs:{prop:"valueSelect","header-align":"center",align:"center",label:"可选值列表"}})],1),n._v(" "),e("el-pagination",{attrs:{"current-page":n.pageIndex,"page-sizes":[10,20,50,100],"page-size":n.pageSize,total:n.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":n.sizeChangeHandle,"current-change":n.currentChangeHandle}})],1),n._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(t){n.innerVisible=!1}}},[n._v("取 消")]),n._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:n.submitAddRealtion}},[n._v("确认新增")])],1)]),n._v(" "),e("el-row",[e("el-col",{attrs:{span:24}},[e("el-button",{attrs:{type:"primary"},on:{click:n.addRelation}},[n._v("新建关联")]),n._v(" "),e("el-button",{attrs:{type:"danger",disabled:n.dataListSelections.length<=0},on:{click:n.batchDeleteRelation}},[n._v("批量删除")]),n._v(" "),e("el-table",{staticStyle:{width:"100%"},attrs:{data:n.relationAttrs,border:""},on:{"selection-change":n.selectionChangeHandle}},[e("el-table-column",{attrs:{type:"selection","header-align":"center",align:"center",width:"50"}}),n._v(" "),e("el-table-column",{attrs:{prop:"attrId",label:"#"}}),n._v(" "),e("el-table-column",{attrs:{prop:"attrName",label:"属性名"}}),n._v(" "),e("el-table-column",{attrs:{prop:"valueSelect",label:"可选值"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-tooltip",{attrs:{placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},n._l(t.row.valueSelect.split(";"),function(t,a){return e("span",{key:a},[n._v("\n                    "+n._s(t)+"\n                    "),e("br")])})),n._v(" "),e("el-tag",[n._v(n._s(t.row.valueSelect.split(";")[0]+" ..."))])],1)]}}])}),n._v(" "),e("el-table-column",{attrs:{fixed:"right","header-align":"center",align:"center",label:"操作"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){n.relationRemove(t.row.attrId)}}},[n._v("移除")])]}}])})],1)],1)],1)],1)],1)},staticRenderFns:[]};var r=e("VU/8")(a,i,!1,function(n){e("Bq2z")},"data-v-7a4e3e7f",null);t.default=r.exports}});